

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mathematical Background &mdash; WDM 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=86424434" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="WDM Package" href="modules.html" />
    <link rel="prev" title="WDM_GW_wavelets documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            WDM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Mathematical Background:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Mathematical Background</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fourier-transform-conventions">Fourier Transform Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#meyer-window">Meyer Window</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wdm-wavelets">WDM Wavelets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-discrete-wavelet-transform">The Discrete Wavelet Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="#units">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="#glossary">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="#appendices">Appendices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#normalised-incomplete-beta-function">Normalised Incomplete Beta Function</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">WDM Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code Repository:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="GitHub.html">GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">WDM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Mathematical Background</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/theory.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mathematical-background">
<h1>Mathematical Background<a class="headerlink" href="#mathematical-background" title="Link to this heading"></a></h1>
<p>This section describes the mathematical background to the WDM wavelet transform.</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id24">Introduction</a></p></li>
<li><p><a class="reference internal" href="#fourier-transform-conventions" id="id25">Fourier Transform Conventions</a></p></li>
<li><p><a class="reference internal" href="#meyer-window" id="id26">Meyer Window</a></p></li>
<li><p><a class="reference internal" href="#wdm-wavelets" id="id27">WDM Wavelets</a></p></li>
<li><p><a class="reference internal" href="#the-discrete-wavelet-transform" id="id28">The Discrete Wavelet Transform</a></p></li>
<li><p><a class="reference internal" href="#units" id="id29">Units</a></p></li>
<li><p><a class="reference internal" href="#glossary" id="id30">Glossary</a></p></li>
<li><p><a class="reference internal" href="#references" id="id31">References</a></p></li>
<li><p><a class="reference internal" href="#appendices" id="id32">Appendices</a></p>
<ul>
<li><p><a class="reference internal" href="#normalised-incomplete-beta-function" id="id33">Normalised Incomplete Beta Function</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id24" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>The Wilson-Daubechies-Meyer (WDM) wavelet basis is widely used for gravitational-wave (GW) data analysis.
While far from being the only available choice, the WDM wavelets have several properties that make
them well suited for this purpose:
they are well separated in frequency which connects with the rest of GW data analysis which is almost exclusively done
in the frequency domain;
and they provide a uniform tiling in both time and frequency.
The WDM wavelets were first introduced for GW data analysis in Ref. <a class="footnote-reference brackets" href="#id12" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> (see also Ref. <a class="footnote-reference brackets" href="#id13" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>) and have since been used
in Coherent WaveBurst (CWB; see Refs. <a class="footnote-reference brackets" href="#id14" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> and <a class="footnote-reference brackets" href="#id15" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>).</p>
<p>This document is based on Refs. <a class="footnote-reference brackets" href="#id12" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> and <a class="footnote-reference brackets" href="#id13" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> with only a few minor changes in notation and conventions.
The purpose of this document is to provide a complete, self-contained description of the WDM wavelet
transform to accompany this JAX implementation, spelling out explicitly some details not discussed in the literature
and correcting a few minor typos.</p>
</section>
<section id="fourier-transform-conventions">
<h2><a class="toc-backref" href="#id25" role="doc-backlink">Fourier Transform Conventions</a><a class="headerlink" href="#fourier-transform-conventions" title="Link to this heading"></a></h2>
<p>We use the following Fourier transform conventions:</p>
<div class="math notranslate nohighlight" id="equation-theory-0">
<span class="eqno">(1)<a class="headerlink" href="#equation-theory-0" title="Link to this equation"></a></span>\[\tilde{X}(f) = \int_{-\infty}^{\infty} \mathrm{d}t\; \exp(-2\pi ift) x(t) ,\]</div>
<div class="math notranslate nohighlight" id="equation-theory-1">
<span class="eqno">(2)<a class="headerlink" href="#equation-theory-1" title="Link to this equation"></a></span>\[x(t) = \int_{-\infty}^{\infty} \mathrm{d}f\; \exp(2\pi ift) \tilde{X}(f) .\]</div>
</section>
<section id="meyer-window">
<h2><a class="toc-backref" href="#id26" role="doc-backlink">Meyer Window</a><a class="headerlink" href="#meyer-window" title="Link to this heading"></a></h2>
<p>The WDM wavelet transform is based on the Meyer window function, which is
defined in the frequency domain by</p>
<div class="math notranslate nohighlight" id="equation-theory-2">
<span class="eqno">(3)<a class="headerlink" href="#equation-theory-2" title="Link to this equation"></a></span>\[\begin{split}\tilde{M}(\omega) = \begin{cases}
    \sqrt{\frac{1}{\Delta\Omega}} &amp; \text{if } |\omega| &lt; A, \\
    \sqrt{\frac{1}{\Delta\Omega}}  \cos\left(\frac{\pi}{2}\nu_d\left(\frac{|\omega| -
     A}{B}\right)\right) &amp; \text{if } A \leq |\omega| \leq A + B \\
    0 &amp; \text{if } |\omega| &gt; A + B
\end{cases} ,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(A&gt;0\)</span> and <span class="math notranslate nohighlight">\(B&gt;0\)</span> control the shape of the window.
The parameter <span class="math notranslate nohighlight">\(A\)</span> is the half-width of the flat-top response region and <span class="math notranslate nohighlight">\(B\)</span> is the width of the transition region;
they satisfy <span class="math notranslate nohighlight">\(2A + B = \Delta\Omega\)</span>, where <span class="math notranslate nohighlight">\(\Delta\Omega\)</span> is the total wavelet bandwidth.
See <a class="reference internal" href="#fig-meyer-window"><span class="std std-numref">Figure 1</span></a>.</p>
<figure class="align-center" id="id18">
<span id="fig-meyer-window"></span><a class="reference internal image-reference" href="_images/Meyer_window.png"><img alt="Meyer_window" src="_images/Meyer_window.png" style="width: 90%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 1 </span><span class="caption-text"><em>Top</em>: the Meyer window function <span class="math notranslate nohighlight">\(\tilde{M}(\omega)\)</span> for different values of <span class="math notranslate nohighlight">\(d\)</span>.
<em>Bottom</em>: the time-domain window <span class="math notranslate nohighlight">\(m(t)\)</span>, where <span class="math notranslate nohighlight">\(\Delta T = \pi/\Delta\Omega\)</span>.
The case <span class="math notranslate nohighlight">\(d=4\)</span> matches Fig.1 of Ref. <a class="footnote-reference brackets" href="#id13" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.
Note how the wavelet is well localised in frequency (with compact support) but much less so in time.</span><a class="headerlink" href="#id18" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The Meyer window function has the property that its square integrates to unity.
To show this, first integrate over the flat-top part of the window (line 1),
then let <span class="math notranslate nohighlight">\(x=(\omega-A)/B\)</span> (line 2), then use <span class="math notranslate nohighlight">\(\cos^2 \theta = \frac{1+\cos(2\theta)}{2}\)</span> (line 3),
and finally use the symmetry <span class="math notranslate nohighlight">\(\cos(\pi \nu_d(1-x))=\cos(\pi (1-\nu_d(x))) = \cos(\pi-\pi\nu_d(x)))= -\cos(\pi \nu_d(x))\)</span>
to set the remaining piece of the integral to zero (line 4):</p>
<div class="math notranslate nohighlight" id="equation-theory-3">
<span class="eqno">(4)<a class="headerlink" href="#equation-theory-3" title="Link to this equation"></a></span>\[\begin{split}\begin{align}
\int_{-\infty}^{\infty} \mathrm{d}\omega\; |\tilde{M}(\omega)|^2 &amp;=
   \frac{2A+2\int_{A}^{A+B} \mathrm{d}\omega\; \cos^2\left(\frac{\pi}{2}\nu_d(\frac{\omega-A}{B})\right)}{2A+B}  , \\
   &amp;= \frac{2A+2B \int_0^1 \mathrm{d}x\; \cos^2\left(\frac{\pi}{2}\nu_d(x)\right)}{2A+B} , \\
   &amp;= \frac{2A+2B \left(\frac{1}{2}+\frac{1}{2}\int_0^1\mathrm{d}x\; \cos\left(\pi\nu_d(x)\right)\right)}{2A+B} , \\
   &amp;= 1.
\end{align}\end{split}\]</div>
<p>The Meyer function <span class="math notranslate nohighlight">\(\tilde{M}(\omega)\)</span> is implemented in <a class="reference internal" href="WDM.code.utils.html#WDM.code.utils.Meyer.Meyer" title="WDM.code.utils.Meyer.Meyer"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.utils.Meyer.Meyer()</span></code></a>.</p>
<p>Henceforth, we will work with frequency <span class="math notranslate nohighlight">\(f\)</span> instead of angular frequency <span class="math notranslate nohighlight">\(\omega=2\pi f\)</span>.
This fits with the rest of the GW data analysis community which generally uses <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>For the wavelet transform, the frequency-domain window function is defined as</p>
<div class="math notranslate nohighlight" id="equation-theory-4">
<span class="eqno">(5)<a class="headerlink" href="#equation-theory-4" title="Link to this equation"></a></span>\[\tilde{\Phi}(f) = \sqrt{2\pi} \tilde{M}(2\pi f) ,\]</div>
<p>and the corresponding time-domain window is</p>
<div class="math notranslate nohighlight" id="equation-theory-5">
<span class="eqno">(6)<a class="headerlink" href="#equation-theory-5" title="Link to this equation"></a></span>\[\phi(t) = \int \mathrm{d}f \; \exp(2\pi i ft) \tilde{\Phi}(f)\]</div>
<p>These window functions are implemented in
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.build_frequency_domain_window" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.build_frequency_domain_window"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.build_frequency_domain_window()</span></code></a> and
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.build_time_domain_window" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.build_time_domain_window"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.build_time_domain_window()</span></code></a>.</p>
<p>Unless otherwise stated, the default values <span class="math notranslate nohighlight">\(A=\Delta\Omega/4\)</span>, <span class="math notranslate nohighlight">\(B=\Delta\Omega/2\)</span>, and
<span class="math notranslate nohighlight">\(d=4\)</span> will be used throughout the rest of this document.</p>
</section>
<section id="wdm-wavelets">
<h2><a class="toc-backref" href="#id27" role="doc-backlink">WDM Wavelets</a><a class="headerlink" href="#wdm-wavelets" title="Link to this heading"></a></h2>
<p>Consider a real-valued function of time <span class="math notranslate nohighlight">\(x(t)\)</span>.
The discretely sampled time series <span class="math notranslate nohighlight">\(x[k]=x(t_k)\)</span> is indexed by <span class="math notranslate nohighlight">\(k\in\{0, 1, \ldots, N-1\}\)</span>
and evaluated at the sample times <span class="math notranslate nohighlight">\(t_k=k\delta t\)</span>, where <span class="math notranslate nohighlight">\(\delta t\)</span> is the cadence and
<span class="math notranslate nohighlight">\(f_s = \frac{1}{\delta t}\)</span> is the sampling frequency.
The total duration of the time series is <span class="math notranslate nohighlight">\(T=N\delta t\)</span>,
and the Nyquist frequency is <span class="math notranslate nohighlight">\(f_{\rm Ny}=\frac{1}{2\delta t}\)</span>.
The frequency resolution is <span class="math notranslate nohighlight">\(\delta f = \frac{1}{T}\)</span>.</p>
<p>The WDM wavelet transform represents the time series using <span class="math notranslate nohighlight">\(N_f\)</span> frequency slices of width <span class="math notranslate nohighlight">\(\Delta F\)</span>
and <span class="math notranslate nohighlight">\(N_t\)</span> time slices of width <span class="math notranslate nohighlight">\(\Delta T\)</span>;</p>
<div class="math notranslate nohighlight" id="equation-theory-6">
<span class="eqno">(7)<a class="headerlink" href="#equation-theory-6" title="Link to this equation"></a></span>\[\Delta T = N_f \delta t ,\]</div>
<div class="math notranslate nohighlight" id="equation-theory-7">
<span class="eqno">(8)<a class="headerlink" href="#equation-theory-7" title="Link to this equation"></a></span>\[\Delta F = \frac{1}{2 N_f \delta t} = \frac{N_t}{2T} .\]</div>
<p>There are <span class="math notranslate nohighlight">\(N=N_t N_f\)</span> cells, each with area <span class="math notranslate nohighlight">\(\Delta T \Delta F = \frac{1}{2}\)</span>.
These cells uniformly tile the time–frequency plane.
<strong>We insist that both</strong> <span class="math notranslate nohighlight">\(N_t\)</span> <strong>and</strong> <span class="math notranslate nohighlight">\(N_f\)</span> <strong>are even.</strong> This implies that <span class="math notranslate nohighlight">\(N\)</span> is also even.
Although not necessary, this simplifies some formulae and is not a significant limitation in practice.</p>
<p>The WDM wavelets <span class="math notranslate nohighlight">\(g_{nm}(t)\)</span> are constructed from the Meyer window function <span class="math notranslate nohighlight">\(\phi\)</span>.
The indices <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(m\)</span> label the time and frequency slices respectively.
In the time-domain an orthonormal Wilson wavelet basis (Refs. <a class="footnote-reference brackets" href="#id16" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a> and <a class="footnote-reference brackets" href="#id17" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>) can be defined as</p>
<div class="math notranslate nohighlight" id="equation-theory-8">
<span class="eqno">(9)<a class="headerlink" href="#equation-theory-8" title="Link to this equation"></a></span>\[\begin{split}g_{nm}(t) = \begin{cases}
     \phi(t-2n\Delta T) &amp; \mathrm{if}\;m=0 \\
     \begin{cases}
         \sqrt{2} (-1)^{mn} \cos\left(\frac{\pi m t}{\Delta T}\right) \phi(t-n\Delta T) &amp; \mathrm{if}\;n+m\;\mathrm{even}\\
         \sqrt{2} \sin\left(\frac{\pi m t}{\Delta T}\right) \phi(t-n\Delta T) &amp; \mathrm{if}\;n+m\;\mathrm{odd}
     \end{cases} &amp; \mathrm{if}\;m&gt;0
     \end{cases} .\end{split}\]</div>
<p>Taking the Fourier transform, it is straightforward to show that the frequency-domain basis wavelets are given by</p>
<div class="math notranslate nohighlight" id="equation-theory-9">
<span class="eqno">(10)<a class="headerlink" href="#equation-theory-9" title="Link to this equation"></a></span>\[\begin{split}\tilde{G}_{nm}(f) = \begin{cases}
    \exp(-4\pi i n f \Delta T) \tilde{\Phi}(f) &amp; \mathrm{if}\;m=0 \\
    \frac{\exp(-2\pi i n f \Delta T)}{\sqrt{2}} \left( C_{nm}\tilde{\Phi}(f+m\Delta F)
    +C^*_{nm}\tilde{\Phi}(f-m\Delta F) \right) &amp; \mathrm{if}\;m&gt;0
\end{cases} ,\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-theory-10">
<span class="eqno">(11)<a class="headerlink" href="#equation-theory-10" title="Link to this equation"></a></span>\[\begin{split}C_{nm} = \begin{cases} 1 &amp; \mathrm{if}\;n+m\;\mathrm{even} \\
                       i &amp; \mathrm{if}\;n+m\;\mathrm{odd} \end{cases} .\end{split}\]</div>
<p>If the time index is allowed to vary in the range <span class="math notranslate nohighlight">\(n\in\{0,1,\ldots,N_t-1\}\)</span> then the wavelet
basis covers the full range of the time series.
However, in order to cover the full frequency range (up to the Nyquist frequency) the frequency index
must be allowed to vary in the range <span class="math notranslate nohighlight">\(m\in\{0,1,\ldots, N_f\}\)</span> (including <span class="math notranslate nohighlight">\(N_f\)</span>).
The <span class="math notranslate nohighlight">\(m=N_f\)</span> wavelets have support below the Nyquist frequency; see <a class="reference internal" href="#fig-wdm-wavelets-fd"><span class="std std-numref">Figure 2</span></a>.
The case <span class="math notranslate nohighlight">\(m=N_f\)</span> is handled as a special case using the following formulae:</p>
<div class="math notranslate nohighlight" id="equation-theory-11">
<span class="eqno">(12)<a class="headerlink" href="#equation-theory-11" title="Link to this equation"></a></span>\[g_{nN_f}(t) = \cos(2\pi f_{\rm Ny}[t-2n\Delta T]) \phi(t-2n\Delta T),\]</div>
<div class="math notranslate nohighlight" id="equation-theory-12">
<span class="eqno">(13)<a class="headerlink" href="#equation-theory-12" title="Link to this equation"></a></span>\[\tilde{G}_{nN_f}(f) = \frac{1}{2} \exp(-4\pi i n f \Delta T) \left( \tilde{\Phi}(f-f_{\rm Ny}) + \tilde{\Phi}(f+f_{\rm Ny}) \right) .\]</div>
<p>Notice that for most of the wavelets the index <span class="math notranslate nohighlight">\(n\)</span> shifts the wavelets by integer multiples of <span class="math notranslate nohighlight">\(\Delta T\)</span> in time.
However, for <span class="math notranslate nohighlight">\(m=0\)</span> and <span class="math notranslate nohighlight">\(m=N_f\)</span> it shifts them by integer multiples of <span class="math notranslate nohighlight">\(2\Delta T\)</span>.</p>
<p>The WDM wavelets are plotted in the frequency domain in <a class="reference internal" href="#fig-wdm-wavelets-fd"><span class="std std-numref">Figure 2</span></a>.</p>
<figure class="align-center" id="id19">
<span id="fig-wdm-wavelets-fd"></span><a class="reference internal image-reference" href="_images/Gnm_spectra.png"><img alt="Gnm_spectra" src="_images/Gnm_spectra.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 2 </span><span class="caption-text">The <span class="math notranslate nohighlight">\(d=4\)</span> WDM wavelets <span class="math notranslate nohighlight">\(|\tilde{G}_{nm}(f)|\)</span> plotted in the frequency domain for
<span class="math notranslate nohighlight">\(m=0, 1, 2,\ldots,N_f\)</span>.
Wavelets computed using <span class="math notranslate nohighlight">\(N_f=16\)</span> are shown to match Fig.2 of Ref. <a class="footnote-reference brackets" href="#id12" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</span><a class="headerlink" href="#id19" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>As defined, the index <span class="math notranslate nohighlight">\(m\)</span> takes on both values 0 and <span class="math notranslate nohighlight">\(N_f\)</span>.
However, these two cases can be conveniently grouped together.
Because of the <span class="math notranslate nohighlight">\(2\Delta T\)</span> time shift, only half of the <span class="math notranslate nohighlight">\(n\)</span> range is needed for these <span class="math notranslate nohighlight">\(m\)</span> indices;
therefore, we redefine <span class="math notranslate nohighlight">\(G_{n0}(f):=G_{nN_f}(f)\)</span> when <span class="math notranslate nohighlight">\(n\geq N_t/2\)</span>.
With this choice, the index ranges <span class="math notranslate nohighlight">\(n\in\{0,1,\ldots,N_t-1\}\)</span> and <span class="math notranslate nohighlight">\(m\in\{0,1,\ldots,N_f-1\}\)</span>
cover the entire time-frequency plane; see <a class="reference internal" href="#fig-wdm-wavelets-animate"><span class="std std-numref">Figure 5</span></a>.
The central time and frequency of the wavelet <span class="math notranslate nohighlight">\(g_{nm}(t)\)</span> are given by</p>
<div class="math notranslate nohighlight" id="equation-theory-13">
<span class="eqno">(14)<a class="headerlink" href="#equation-theory-13" title="Link to this equation"></a></span>\[\begin{split}t_{nm} = \begin{cases} 2 n \Delta T &amp; \mathrm{if}\;m=0 \\
                  n \Delta T &amp; \mathrm{if}\;m&gt;0 \end{cases} \,,\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-theory-14">
<span class="eqno">(15)<a class="headerlink" href="#equation-theory-14" title="Link to this equation"></a></span>\[\begin{split}f_{nm} = \begin{cases} \begin{cases}0&amp;\mathrm{if}\;n&lt;N_t/2\\
                        f_{\rm Ny}&amp;\mathrm{if}\,n\geq N_t/2\end{cases} &amp; \mathrm{if}\;m=0 \\
                  m \Delta F &amp; \mathrm{if}\;m&gt;0 \end{cases} \,.\end{split}\]</div>
<p>These expressions are implemented in
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.wavelet_central_time_frequency" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.wavelet_central_time_frequency"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.wavelet_central_time_frequency()</span></code></a>.</p>
<p>Examples of the WDM wavelets with <span class="math notranslate nohighlight">\(N=512\)</span>, <span class="math notranslate nohighlight">\(N_f=16\)</span>, and <span class="math notranslate nohighlight">\(\delta t=1\)</span>
are shown in <a class="reference internal" href="#fig-wdm-wavelets-td"><span class="std std-numref">Figure 3</span></a>, <a class="reference internal" href="#fig-wdm-wavelets-tf"><span class="std std-numref">Figure 4</span></a>, and <a class="reference internal" href="#fig-wdm-wavelets-animate"><span class="std std-numref">Figure 5</span></a>.
Notice that the WDM wavelets are well localised in frequency but much less so in time.</p>
<figure class="align-center" id="id20">
<span id="fig-wdm-wavelets-td"></span><a class="reference internal image-reference" href="_images/gnm_wavelets.png"><img alt="gnm_wavelets" src="_images/gnm_wavelets.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 3 </span><span class="caption-text">The time-domain WDM wavelets <span class="math notranslate nohighlight">\(g_{nm}(t)\)</span> for selected values of <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(m\)</span>.</span><a class="headerlink" href="#id20" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id21">
<span id="fig-wdm-wavelets-tf"></span><a class="reference internal image-reference" href="_images/wavelets_TF.png"><img alt="wavelets_TF" src="_images/wavelets_TF.png" style="width: 90%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 4 </span><span class="caption-text">The WDM wavelets plotted in both time (top) and frequency (right) domain for selected <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(m\)</span>.
The main plot shows a time-frequency grid shaded to indicate where the wavelets have support.</span><a class="headerlink" href="#id21" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id22">
<span id="fig-wdm-wavelets-animate"></span><a class="reference internal image-reference" href="_images/wavelet_animation.gif"><img alt="wavelet_animation" src="_images/wavelet_animation.gif" style="width: 90%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 5 </span><span class="caption-text">Animated version of <a class="reference internal" href="#fig-wdm-wavelets-tf"><span class="std std-numref">Figure 4</span></a> looping through all the wavelets.
Notice in particular the behaviour of the wavelets for <span class="math notranslate nohighlight">\(m=0\)</span>.</span><a class="headerlink" href="#id22" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The discretely sampled WDM wavelets have the following orthonormality properties:</p>
<div class="math notranslate nohighlight" id="equation-theory-15">
<span class="eqno">(16)<a class="headerlink" href="#equation-theory-15" title="Link to this equation"></a></span>\[\delta t \sum_{k=0}^{N-1} g_{nm}[k] g_{n'm'}[k] = \delta_{nn'} \delta_{mm'} .\]</div>
<div class="math notranslate nohighlight" id="equation-theory-16">
<span class="eqno">(17)<a class="headerlink" href="#equation-theory-16" title="Link to this equation"></a></span>\[\delta f \sum_{\ell=-N/2}^{N/2-1} \tilde{G}_{nm}[\ell] \tilde{G}^*_{n'm'}[\ell] = \delta_{nn'} \delta_{mm'} .\]</div>
<p>The frequency-domain WDM wavelets <span class="math notranslate nohighlight">\(\tilde{G}_{nm}(f)\)</span> are implemented in
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.Gnm" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.Gnm"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.Gnm()</span></code></a> or
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.Gnm_basis" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.Gnm_basis"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.Gnm_basis()</span></code></a>.</p>
<p>The time-domain WDM wavelets <span class="math notranslate nohighlight">\(g_{nm}(t)\)</span> are implemented in
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.gnm" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.gnm"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.gnm()</span></code></a> or
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.gnm_basis" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.gnm_basis"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.gnm_basis()</span></code></a>.</p>
</section>
<section id="the-discrete-wavelet-transform">
<h2><a class="toc-backref" href="#id28" role="doc-backlink">The Discrete Wavelet Transform</a><a class="headerlink" href="#the-discrete-wavelet-transform" title="Link to this heading"></a></h2>
<p>The WDM wavelets form a complete orthonormal basis for real-valued, discretely sampled time series,</p>
<div class="math notranslate nohighlight" id="equation-theory-17">
<span class="eqno">(18)<a class="headerlink" href="#equation-theory-17" title="Link to this equation"></a></span>\[x[k] = \sum_{n=0}^{N_t-1} \sum_{m=0}^{N_f-1} w_{nm} g_{nm}[k] .\]</div>
<p>Here, <span class="math notranslate nohighlight">\(x[k]\)</span> is the input time series, <span class="math notranslate nohighlight">\(w_{nm}\)</span> are the wavelet coefficients, and <span class="math notranslate nohighlight">\(g_{nm}[k]\)</span> are the
WDM wavelet basis functions.</p>
<p>An expression for the wavelet coefficients <span class="math notranslate nohighlight">\(w_{nm}\)</span> can be derived by multiplying both sides of this
equation by <span class="math notranslate nohighlight">\(\delta t \, g_{n'm'}[k]\)</span>, summing over <span class="math notranslate nohighlight">\(k\)</span>, and using the above orthonormality property to obtain</p>
<div class="math notranslate nohighlight" id="equation-theory-18">
<span class="eqno">(19)<a class="headerlink" href="#equation-theory-18" title="Link to this equation"></a></span>\[w_{nm} = \delta t\sum_{k=0}^{N-1} x[k] g_{nm}[k] .\]</div>
<p>This is the exact expression for the forward wavelet transform which transforms from the time domain
to the time-frequency domain.</p>
<p>This <em>exact</em> wavelet transform is implemented in
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_exact" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_exact"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_exact()</span></code></a>.</p>
<p>The exact form of the wavelet transform described above and with the double sum evaluated explicitly is slow to evaluate.
The rest of this section describes several alternative formulations of the wavelet transform leading eventually to a fast
implementation based on the FFT of the time series data.</p>
<p>One way to speed up the wavelet transform is to notice that the WDM wavelets are (approximately) localised in time.
Therefore, we don’t need to sum over all values of <span class="math notranslate nohighlight">\(k\)</span> when evaluating the wavelet coefficients.
The sum can be truncated to a window of length <span class="math notranslate nohighlight">\(K=2qN_f\)</span> without significant loss of accuracy.
The truncation parameter <span class="math notranslate nohighlight">\(1\leq q\leq N_t/2\)</span> is a positive integer that controls the length of the window.
The truncated window must be centered at the time where the wavelet amplitude is largest.
The truncated wavelet transform is given by</p>
<div class="math notranslate nohighlight" id="equation-theory-19">
<span class="eqno">(20)<a class="headerlink" href="#equation-theory-19" title="Link to this equation"></a></span>\[w_{n0} = \delta t\sum_{k=-K/2}^{K/2-1}
                  g_{n0}[k + 2 n N_f] x[k + 2 n N_f] ,\]</div>
<div class="math notranslate nohighlight" id="equation-theory-20">
<span class="eqno">(21)<a class="headerlink" href="#equation-theory-20" title="Link to this equation"></a></span>\[w_{nm} = \delta t\sum_{k=-K/2}^{K/2-1}
                  g_{nm}[k + n N_f] x[k + n N_f] \quad \mathrm{for} \; m&gt;0.\]</div>
<p>In expressions such as these, indices that are out of bounds of the array are to be understood as wrapping
around circularly; i.e. <span class="math notranslate nohighlight">\(x[-1] = x[N-1]\)</span> and <span class="math notranslate nohighlight">\(x[N] = x[0]\)</span>.</p>
<p>This form of the <em>truncated</em> wavelet transform is implemented in
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_truncated" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_truncated"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_truncated()</span></code></a>.</p>
<p>Smaller values of <span class="math notranslate nohighlight">\(q\)</span> yield faster but less accurate wavelet transforms.
The accuracy of this truncated wavelet transform is explored in the example notebook <a class="reference internal" href="accuracy_truncated_transform.html"><span class="doc">Exploring the accuracy of the truncated wavelet transform</span></a>.</p>
<p>The truncated wavelet transform can be rewritten in terms of the window function <span class="math notranslate nohighlight">\(\phi[k]\)</span>;</p>
<div class="math notranslate nohighlight" id="equation-theory-21">
<span class="eqno">(22)<a class="headerlink" href="#equation-theory-21" title="Link to this equation"></a></span>\[\begin{split}w_{n0} = \delta t \begin{cases}
\sum_{k=-K/2}^{K/2-1} x[k+2nN_f]\phi[k] &amp; \mathrm{if}\;n&lt;N_t/2 \\
\sum_{k=-K/2}^{K/2-1} (-1)^k x[k+2nN_f]\phi[k] &amp; \mathrm{if}\;n\geq N_t/2 \\
 \end{cases} ,\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-theory-22">
<span class="eqno">(23)<a class="headerlink" href="#equation-theory-22" title="Link to this equation"></a></span>\[w_{nm} = \sqrt{2}\delta t \, \mathrm{Re} \sum_{k=-K/2}^{K/2-1} C^*_{nm}
   \exp\left(\frac{i\pi km}{N_f}\right) x[k+nN_f] \phi[k] \quad \mathrm{for}\; m&gt;0.\]</div>
<p>To derive these expressions, substitute the definitions of the time-domain wavelets <span class="math notranslate nohighlight">\(g_{nm}[k]\)</span> in
Eq.9 (and the special case in Eq.12) into the truncated expressions for the wavelet coefficients in Eqs.22 and 23.</p>
<p>This form of the <em>truncated window</em> wavelet transform using <span class="math notranslate nohighlight">\(\phi[k]\)</span> is implemented in
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_truncated_window" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_truncated_window"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_truncated_window()</span></code></a>.</p>
<p>The need to handle the <span class="math notranslate nohighlight">\(m=0\)</span> terms separately can slow down the wavelet transform.
This is often unnecessary as the lowest and highest frequency parts of the signal are often not needed.
Therefore, by default the <cite>WDM_transform</cite> class that implements these transformations will not use the
formulae for the special case <span class="math notranslate nohighlight">\(m=0\)</span> and therefore miscalculates these coefficients.
If the <span class="math notranslate nohighlight">\(m=0\)</span> coefficients are needed, then the class should be initialised with the keyword argument <cite>calc_m0=True</cite>.
The effect of getting the <span class="math notranslate nohighlight">\(m=0\)</span> coefficients wrong on the signal reconstructed from the wavelet coefficients
is explored in the example notebook <a class="reference internal" href="m_equal_0_terms.html"><span class="doc">m=0 Wavelet Coefficients</span></a>.</p>
<p>The wavelet transform can be considerably sped up by exploiting the fast Fourier transform (FFT) algorithm.
Let us define</p>
<div class="math notranslate nohighlight" id="equation-theory-23">
<span class="eqno">(24)<a class="headerlink" href="#equation-theory-23" title="Link to this equation"></a></span>\[X_n[j] = \sum_{k=-K/2}^{K/2-1} \exp(2\pi i kj/K) x[nN_f+k] \phi[k] .\]</div>
<p>This can be thought of as a short FFT. (Although, with our conventions it’s actually an inverse FFT.)
The data is first split into <span class="math notranslate nohighlight">\(N_t\)</span> overlapping segments of length <span class="math notranslate nohighlight">\(K\)</span>,
each segment is multiplied by the window function <span class="math notranslate nohighlight">\(\phi[k]\)</span>
and the (inverse) FFT is applied to each segment.</p>
<p>The short FFT to calculate <span class="math notranslate nohighlight">\(X_n[j]\)</span> is implemented in
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.short_fft" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.short_fft"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.short_fft()</span></code></a>.</p>
<p>The expression for the wavelet coefficients in Eq.23 can be rewritten using this short FFT downsampled to
extract every <span class="math notranslate nohighlight">\(q^{\rm th}\)</span> coefficient,</p>
<div class="math notranslate nohighlight" id="equation-theory-24">
<span class="eqno">(25)<a class="headerlink" href="#equation-theory-24" title="Link to this equation"></a></span>\[w_{nm} = \sqrt{2} \delta t \, \mathrm{Re}\, C_{nm}^* X_n[mq] \quad \mathrm{for}\; m&gt;0.\]</div>
<p>This formula for the wavelet coefficients only holds for <span class="math notranslate nohighlight">\(m&gt;0\)</span>. If the <span class="math notranslate nohighlight">\(m=0\)</span> terms
are required they are calculated using the truncated window expressions above (Eq.22).</p>
<p>This <em>short FFT</em> form of the wavelet transform is implemented in
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_short_fft" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_short_fft"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_short_fft()</span></code></a>.</p>
<p>This is pretty fast. But it turns out that a further speed up is possible if instead
we perform the full FFT on the original time series, rather than the short FFT.
The reason this is faster is to do with the fact that our chosen WDM wavelets are better localised in the
frequency domain than in the time domain (see discussion in  Ref. <a class="footnote-reference brackets" href="#id12" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>).
This also has the benefit of not introducing any truncation errors in the forward wavelet transform because
the WDM wavelets have compact support in frequency.</p>
<p>To derive this FFT expression for the wavelet transform…</p>
<div class="math notranslate nohighlight" id="equation-theory-25">
<span class="eqno">(26)<a class="headerlink" href="#equation-theory-25" title="Link to this equation"></a></span>\[x_m[n] = \sum_{l=-N_t/2}^{N_t/2-1} \exp\left(\frac{2\pi i nl}{N_t}\right) \Phi[l] X[l-mN_t/2] .\]</div>
<div class="math notranslate nohighlight" id="equation-theory-26">
<span class="eqno">(27)<a class="headerlink" href="#equation-theory-26" title="Link to this equation"></a></span>\[w_{nm} = \frac{\sqrt{2}\delta t}{N} (-1)^{nm} \,\mathrm{Re}\, \Big( C_{nm}^* x_m[n] \Big)  \quad \mathrm{for}\; m&gt;0.\]</div>
<p>This is our final <em>FFT</em> form of the wavelet transform and is implemented in
<a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_fft" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_fft"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.discrete_wavelet_transform.WDM.WDM_transform.forward_transform_fft()</span></code></a>.</p>
<p>Again, this FFT expression for the wavelet coefficients only holds for <span class="math notranslate nohighlight">\(m&gt;0\)</span>. If the <span class="math notranslate nohighlight">\(m=0\)</span> terms
are required they are calculated using the truncated window expressions above (Eq.22).</p>
<p>This <em>FFT</em> form of the wavelet transform is the fast version intended for production use.
This method is also vectorised to allow for efficient batch processing of multiple time series.</p>
<p>The speed of all the implementations discussed here are compared in the example notebook <a class="reference internal" href="benchmarking.html"><span class="doc">Benchmarking</span></a>.</p>
</section>
<section id="units">
<h2><a class="toc-backref" href="#id29" role="doc-backlink">Units</a><a class="headerlink" href="#units" title="Link to this heading"></a></h2>
<p>The time-domain wavelets have dimension <span class="math notranslate nohighlight">\(\big[g_{nm}\big]=\sqrt{1/\mathrm{time}}\)</span> and
the frequency-domain wavelets have dimension <span class="math notranslate nohighlight">\(\big[\tilde{G}_{nm}\big]=\sqrt{\mathrm{time}}\)</span>.</p>
<p>If the time series <span class="math notranslate nohighlight">\(x(t_k)=x[k]\)</span> has dimension <span class="math notranslate nohighlight">\(\big[x\big]=\alpha\)</span>
then the wavelet coefficients have dimension <span class="math notranslate nohighlight">\(\big[w_{nm}\big]=\alpha\sqrt{\mathrm{time}}\)</span>.</p>
</section>
<section id="glossary">
<h2><a class="toc-backref" href="#id30" role="doc-backlink">Glossary</a><a class="headerlink" href="#glossary" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(t\)</span>: Time (e.g. seconds).</p></li>
<li><p><span class="math notranslate nohighlight">\(f\)</span>: Frequency (e.g. Hertz).</p></li>
<li><p><span class="math notranslate nohighlight">\(\omega\)</span>: Angular frequency (radians per unit time). Defined as <span class="math notranslate nohighlight">\(\omega=2\pi f\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\delta t\)</span>: Time series cadence (time units). Named <code class="docutils literal notranslate"><span class="pre">dt</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(f_{\rm Ny}\)</span>: Nyquist frequency, or the maximum frequency (frequency units). Defined as <span class="math notranslate nohighlight">\(f_{\rm Ny}=\frac{1}{2 \delta t}\)</span>. Named <code class="docutils literal notranslate"><span class="pre">f_Ny</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(f_{s}\)</span>: Sampling frequency (frequency units). Defined as <span class="math notranslate nohighlight">\(f_{s}=\frac{1}{\delta t}\)</span>. Named <code class="docutils literal notranslate"><span class="pre">f_s</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(A\)</span>: Width of flat-top response in the Meyer window (radians per unit time). Named <code class="docutils literal notranslate"><span class="pre">A</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(B\)</span>: Width of transition region in the Meyer window (radians per unit time). Named <code class="docutils literal notranslate"><span class="pre">B</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta\Omega\)</span>: Angular frequency resolution of the wavelets (radians per unit time). Satisfies <span class="math notranslate nohighlight">\(\Delta\Omega = 2A + B\)</span>. Named <code class="docutils literal notranslate"><span class="pre">dOmega</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta F\)</span>: Frequency resolution of the wavelets (frequency units). Satisfies <span class="math notranslate nohighlight">\(\Delta F = \frac{\Delta\Omega}{2\pi}\)</span>. Named <code class="docutils literal notranslate"><span class="pre">dF</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta T\)</span>: Time resolution of the wavelets (time units). Satisfies <span class="math notranslate nohighlight">\(\Delta T \Delta F= \frac{1}{2}\)</span>. Named <code class="docutils literal notranslate"><span class="pre">dT</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(d\)</span>: Steepness parameter for the Meyer window. Named <code class="docutils literal notranslate"><span class="pre">d</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(q\)</span>: Truncation parameter for the freqency-domain window. Named <code class="docutils literal notranslate"><span class="pre">q</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_f\)</span>: Number of frequency bands for the wavelets. Named <code class="docutils literal notranslate"><span class="pre">Nf</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(N_t\)</span>: Number of time bands for the wavelets, must be even. Named <code class="docutils literal notranslate"><span class="pre">Nt</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span>: Number of points in the time series. Satisfies <span class="math notranslate nohighlight">\(N = N_t N_f\)</span>. Named <code class="docutils literal notranslate"><span class="pre">N</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(T\)</span>: Duration of the time series (time units). Satisfies <span class="math notranslate nohighlight">\(T = N \delta t\)</span>. Named <code class="docutils literal notranslate"><span class="pre">T</span></code> in <a class="reference internal" href="WDM.code.discrete_wavelet_transform.html#WDM.code.discrete_wavelet_transform.WDM.WDM_transform" title="WDM.code.discrete_wavelet_transform.WDM.WDM_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM_transform</span></code></a>.</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span>: Time index for the wavelets. In the range <span class="math notranslate nohighlight">\(n\in\{0,1,\ldots, N_t-1\}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span>: Frequency index for the wavelets. In the range <span class="math notranslate nohighlight">\(m\in\{0,1,\ldots, N_f-1\}\)</span>. The <span class="math notranslate nohighlight">\(m=0\)</span> terms store both the zero frequency (<span class="math notranslate nohighlight">\(f\approx 0\)</span>) and the Nyquist frequency (<span class="math notranslate nohighlight">\(f\approx f_{\rm Ny}\)</span>) terms.</p></li>
<li><p><span class="math notranslate nohighlight">\(x[k]\)</span>: Time series data, where <span class="math notranslate nohighlight">\(k\in\{0,1,\ldots,N-1\}\)</span> indexes the time.</p></li>
<li><p><span class="math notranslate nohighlight">\(\tilde{\Phi}(f)\)</span>: Frequency-domain window function, <span class="math notranslate nohighlight">\(\tilde{\Phi}(f)=\sqrt{2\pi}\tilde{M}(2\pi f)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\phi(t)\)</span>: Time-domain Meyer window, defined as the inverse Fourier transform of <span class="math notranslate nohighlight">\(\tilde{\Phi}(\omega)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\tilde{G}_{nm}(f)\)</span>: Frequency-domain WDM wavelet.</p></li>
<li><p><span class="math notranslate nohighlight">\(g_{nm}(t)\)</span>: Time-domain WDM wavelet, defined as the inverse Fourier transform of <span class="math notranslate nohighlight">\(\tilde{G}_{nm}(\omega)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(w_{nm}\)</span>: The wavelet coefficients.</p></li>
</ul>
</section>
<section id="references">
<h2><a class="toc-backref" href="#id31" role="doc-backlink">References</a><a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id12" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id5">2</a>,<a role="doc-backlink" href="#id10">3</a>,<a role="doc-backlink" href="#id11">4</a>)</span>
<p>V. Necula, S. Klimenko &amp; G. Mitselmakher, <em>Transient analysis with fast Wilson-Daubechies time-frequency transform</em>, Journal of Physics: Conference Series 363 012032, 2012.
<a class="reference external" href="https://iopscience.iop.org/article/10.1088/1742-6596/363/1/012032">DOI 10.1088/1742-6596/363/1/012032</a></p>
</aside>
<aside class="footnote brackets" id="id13" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id6">2</a>,<a role="doc-backlink" href="#id7">3</a>)</span>
<p>N. J. Cornish, <em>Time-Frequency Analysis of Gravitational Wave Data</em>, Physical Review D 102 124038, 2020.
<a class="reference external" href="https://arxiv.org/abs/2009.00043">arXiv:2009.00043</a></p>
</aside>
<aside class="footnote brackets" id="id14" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>S. Klimenko, S. Mohanty, M. Rakhmanov &amp; G. Mitselmakher, <em>Constraint likelihood analysis for a network of gravitational wave detectors</em>, Physical Review D 72, 122002, 2005.
<a class="reference external" href="https://arxiv.org/abs/gr-qc/0508068">arXiv:gr-qc/0508068</a></p>
</aside>
<aside class="footnote brackets" id="id15" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p>S. Klimenko <em>et al.</em>, <em>Method for detection and reconstruction of gravitational wave transients with networks of advanced detectors</em>, Physical Review D 93, 042004, 2016.
<a class="reference external" href="https://arxiv.org/abs/1511.05999">arXiv:1511.05999</a></p>
</aside>
<aside class="footnote brackets" id="id16" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">5</a><span class="fn-bracket">]</span></span>
<p>K. G. Wilson, <em>Generalized Wannier functions</em>, preprint, Cornell University.
<a class="reference external" href="https://">link</a></p>
</aside>
<aside class="footnote brackets" id="id17" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">6</a><span class="fn-bracket">]</span></span>
<p>I. Daubechies, S. Jaffard &amp; J. L. Journé, <em>A simple Wilson orthonormal basis with exponential decay</em>, SIAM Journal on Mathematical Analysis, 22, 2, 554–572, 1991.
<a class="reference external" href="https://doi.org/10.1137/0522035">DOI 10.1137/0522035</a></p>
</aside>
</aside>
</section>
<section id="appendices">
<h2><a class="toc-backref" href="#id32" role="doc-backlink">Appendices</a><a class="headerlink" href="#appendices" title="Link to this heading"></a></h2>
<section id="normalised-incomplete-beta-function">
<h3><a class="toc-backref" href="#id33" role="doc-backlink">Normalised Incomplete Beta Function</a><a class="headerlink" href="#normalised-incomplete-beta-function" title="Link to this heading"></a></h3>
<p>The WDM wavelets use the normalised incomplete beta function, <span class="math notranslate nohighlight">\(\nu_d(x)\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-theory-27">
<span class="eqno">(28)<a class="headerlink" href="#equation-theory-27" title="Link to this equation"></a></span>\[\nu_d(x) = \frac{ \int_0^x \mathrm{d}t \, t^{d-1} (1 - t)^{d-1} }
                      { \int_0^1 \mathrm{d}t \, t^{d-1} (1 - t)^{d-1} } ,
                      \quad \mathrm{for}\; 0\leq x\leq 1.\]</div>
<p>This acts as a smooth transition function (or compact sigmoid-like function) from 0 to 1.
The parameter <span class="math notranslate nohighlight">\(d\)</span> controls the steepness of the transition; see <a class="reference internal" href="#fig-norm-incomplete-beta"><span class="std std-numref">Figure 6</span></a>.</p>
<p>The details of this function are actually not very important;
any function that increases smoothly <span class="math notranslate nohighlight">\(\nu(0)=0\)</span> to <span class="math notranslate nohighlight">\(\nu(1)=1\)</span> and
has the symmetry <span class="math notranslate nohighlight">\(\nu(1-x)=1-\nu(x)\)</span> will produce sensible wavelets.</p>
<p>The function <span class="math notranslate nohighlight">\(\nu_d(x)\)</span> is implemented in <a class="reference internal" href="WDM.code.utils.html#WDM.code.utils.Meyer.nu_d" title="WDM.code.utils.Meyer.nu_d"><code class="xref py py-func docutils literal notranslate"><span class="pre">WDM.code.utils.Meyer.nu_d()</span></code></a>.</p>
<figure class="align-center" id="id23">
<span id="fig-norm-incomplete-beta"></span><a class="reference internal image-reference" href="_images/norm_incomplete_beta.png"><img alt="norm_incomplete_beta" src="_images/norm_incomplete_beta.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-number">Figure 6 </span><span class="caption-text">The normalised incomplete beta function <span class="math notranslate nohighlight">\(\nu_d(x)\)</span> for several values of <span class="math notranslate nohighlight">\(d\)</span>.</span><a class="headerlink" href="#id23" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="WDM_GW_wavelets documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="modules.html" class="btn btn-neutral float-right" title="WDM Package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Christopher J. Moore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>